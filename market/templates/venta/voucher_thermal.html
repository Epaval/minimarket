<!-- venta/templates/venta/voucher_thermal.html -->
{% load math_extras %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Comprobante - Market DJ</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      font-size: 12px;
      margin: 4px;
      color: #000;
      background: #fff;
      width: 76mm; /* Ajustado a 80mm con margen */
      line-height: 1.3;
    }
    .header {
      text-align: center;
      margin-bottom: 8px;
      border-bottom: 1px dashed #000;
      padding-bottom: 6px;
    }
    .header h3 {
      margin: 0;
      font-size: 14px;
      font-weight: bold;
    }
    .bar-code {
      text-align: center;
      font-size: 16px;
      font-weight: bold;
      letter-spacing: 2px;
      margin: 6px 0;
    }
    .cliente-info {
      background: #f8f8f8;
      border: 1px dashed #000;
      padding: 4px;
      margin-bottom: 8px;
      font-size: 11px;
    }
    .info {
      margin-bottom: 8px;
      font-size: 11px;
    }
    .info td {
      padding: 2px 0;
    }
    .label {
      font-weight: bold;
      width: 45%;
    }
    .productos {
      margin-bottom: 8px;
      font-size: 11px;
    }
    .productos ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .productos li {
      padding: 1px 0;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .item-name {
      display: inline-block;
      width: 45%;
      vertical-align: top;
    }
    .item-details {
      display: inline-block;
      width: 53%;
      text-align: right;
      vertical-align: top;
    }
    .total {
      text-align: right;
      font-weight: bold;
      font-size: 13px;
      margin-top: 6px;
      border-top: 1px dashed #000;
      padding-top: 6px;
    }
    .footer {
      text-align: center;
      font-size: 10px;
      color: #333;
      margin-top: 10px;
      border-top: 1px dashed #000;
      padding-top: 6px;
    }
  </style>
</head>
<body>

  <!-- Nuevo encabezado compacto -->
<div class="grid-x grid-margin-x" style="margin-bottom: 15px; border-bottom: 1px dashed #000; padding-bottom: 8px;">
  <div class="cell small-3">
    <img src="{{ logo_url }}" alt="Logo" style="width: 60px; height: auto; margin-top: 4px;">
  </div>
  <div class="cell small-9 text-right" style="font-size: 12px; line-height: 1.6;">
    <strong>Market JP C.A</strong><br>
    RIF: J00000000-0<br>
    Av. Comercio 123, Valencia - Venezuela<br>
    Tel: (041) 123-4567
  </div>
</div>

  <div class="bar-code">
    {{ venta.id|stringformat:"06d" }}
  </div>

  {% if venta.cliente %}
    <div class="cliente-info">
      <strong>Cl:</strong> {{ venta.cliente.nombre }} {{ venta.cliente.apellido|default:"" }}<br>
      {% if venta.cliente.dni %}<strong>CI:</strong> {{ venta.cliente.dni }}{% endif %}
    </div>
  {% endif %}

  <div class="info">
    <table>
      <tr><td class="label">N°:</td><td>{{ venta.id|stringformat:"06d" }}</td></tr>
      <tr><td class="label">Fecha:</td><td>{{ venta.date_sale|date:"d/m H:i" }}</td></tr>
      <tr><td class="label">Prod:</td><td>{{ venta.count }}</td></tr>
      <tr><td class="label">Pago:</td><td>{{ venta.get_type_payment_display|truncatechars:8 }}</td></tr>
      <tr><td class="label">Cajero:</td><td>{{ venta.user.full_name|truncatechars:12 }}</td></tr>
    </table>
  </div>

  <div class="productos">
    <h4 style="margin: 0 0 4px 0; font-size: 12px;">DETALLE</h4>
    <ul>
      {% for item in detalle_productos %}
        <li>
          <span class="item-name">{{ item.product.name|truncatechars:18 }}</span>
          <span class="item-details">
            {{ item.count }}x{{ item.price_sale|floatformat:2 }}={{ item.count|mul:item.price_sale|floatformat:2 }}
          </span>
        </li>
      {% endfor %}
    </ul>
  </div>

  <div class="total">
    TOTAL: S/ {{ venta.amount|floatformat:2 }}
  </div>

  <div class="footer">
    <p>¡Gracias!</p>
    <p>Market DJ © {{ venta.date_sale|date:"Y" }}</p>
  </div>

</body>
</html>